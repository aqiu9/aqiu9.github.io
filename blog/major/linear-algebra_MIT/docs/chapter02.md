
# 第二讲：矩阵消元

这个方法最早由高斯提出，我们以前解方程组的时候都会使用，现在来看如何使用矩阵实现消元法。

## 消元法

有三元方程组$$\begin{cases}x&+2y&+z&=2\\3x&+8y&+z&=12\\&4y&+z&=2\end{cases}$$，对应的矩阵形式Ax=b为$$\begin{bmatrix}1&2&1\\3&8&1\\0&4&1\end{bmatrix}\begin{bmatrix}x\\y\\z\end{bmatrix}=\begin{bmatrix}2\\12\\2\end{bmatrix}$$。

按照我们以前做消元法的思路：

* 第一步，我们希望在第二个方程中消去x项，来操作系数矩阵$$A=\begin{bmatrix}\underline{1}&2&1\\3&8&1\\0&4&1\end{bmatrix}$$，下划线的元素为第一步的主元（pivot）：$$\begin{bmatrix}\underline{1}&2&1\\3&8&1\\0&4&1\end{bmatrix}\xrightarrow{row_2-3row_1}\begin{bmatrix}\underline{1}&2&1\\0&2&-2\\0&4&1\end{bmatrix}$$

    这里我们先不管b向量，等做完A的消元可以再做b的消元。（这是MATLAB等工具经常使用的算法。）
* 第二步，我们希望在第三个方程中消去y项，现在第二行第一个非零元素成为了第二个主元：$$\begin{bmatrix}\underline{1}&2&1\\0&\underline{2}&-2\\0&4&1\end{bmatrix}\xrightarrow{row_3-2row_2}\begin{bmatrix}\underline{1}&2&1\\0&\underline{2}&-2\\0&0&\underline{5}\end{bmatrix}$$
  
    注意到第三行消元过后仅剩一个非零元素，所以它就成为第三个主元。做到这里就算消元完成了。

再来讨论一下消元失效的情形：首先，主元不能为零；其次，如果在消元时遇到主元位置为零，则需要交换行，使主元不为零；最后提一下，如果我们把第三个方程z前的系数改成-4，会导致第二步消元时最后一行全部为零，则第三个主元就不存在了，至此消元不能继续进行了，这就是下一讲中涉及的不可逆情况。

* 接下来就该回代（back substitution）了，这时我们在A矩阵后面加上b向量写成增广矩阵（augmented matrix）的形式：$$\left[\begin{array}{c|c}A&b\end{array}\right]=\left[\begin{array}{ccc|c}1&2&1&2\\3&8&1&12\\0&4&1&2\end{array}\right]\to\left[\begin{array}{ccc|c}1&2&1&2\\0&2&-2&6\\0&4&1&2\end{array}\right]\to\left[\begin{array}{ccc|c}1&2&1&2\\0&2&-2&6\\0&0&5&-10\end{array}\right]$$

    不难看出，z的解已经出现了，此时方程组变为$$\begin{cases}x&+2y&+z&=2\\&2y&-2z&=6\\&&5z&=-10\end{cases}$$，从第三个方程求出z=-2，代入第二个方程求出y=1，再代入第一个方程求出x=2。
    
    **这里最终的这种阶梯样子的矩阵称之为*U*(即从A->U)，当A->U时，b->c，即此时等式右侧的结果称之为*c***。为啥化成阶梯式，因为这样的时候就能直观看出结果了，所以定义这种形式为一个概念，就叫阶梯式了

## 消元矩阵

上一讲我们学习了矩阵乘以向量的方法，有三个列向量的矩阵乘以另一个向量，按列的线性组合可以写作$$\Bigg[v_1\ v_2\ v_3\Bigg]\begin{bmatrix}3\\4\\5\end{bmatrix}=3v_1+4v_2+5v_3$$。

但现在我们希望用矩阵乘法表示行操作，则有$$\begin{bmatrix}1&2&7\end{bmatrix}\begin{bmatrix}&row_1&\\&row_2&\\&row_3&\end{bmatrix}=1row_1+2row_2+7row_3$$。易看出这里是一个行向量从左边乘以矩阵，这个行向量按行操作矩阵的行向量，并将其合成为一个矩阵行向量的线性组合。

<u>那*么如果左边是个多行的矩阵呢？那就是相当于堆起来，每一行对应每一行，即下面的内容！ 所以一个很重要的思维和角度就是：左乘行向量就是行的线性组合(等价于一系列行变换)，右乘列向量就是列的线性组合(等价于列变换)，无论左乘右乘，如果不是向量而是矩阵，那就看作几个向量堆在一起或者排在一起，各算各的，最后的结果还按同样的方式堆在一起或者排在一起就好了！*</u>

*<u>如果是右乘初等矩阵，那就是初等矩阵的第一列对应结果的第一列，且第一列分别对应原矩阵的第一列要几个，第二列要几个，第三列要几个。 左乘同理，只不过说的都是行。</u>*

介绍到这里，我们就可以将消元法所做的行操作写成左乘的形式了。

方法就是：左边的矩阵（一系列的行变换等价于左乘一个初等矩阵E，∵左乘->行向量->被变换矩阵的行的线性组合得到对应结果的某一行），E的第一行表示[几个第一行+几个第二行+几个第三行]——>[b的第一行]，第二行第三行同理。变换矩阵的每一行的第几个元素对应右边矩阵的第几行，值是几就是要几倍，最终得到等号右边的第1/2/3行。

* 消元法第一步操作为将第二行改成$$row_2-3row_1$$，其余两行不变，则有$$\begin{bmatrix}1&0&0\\-3&1&0\\0&0&1\end{bmatrix}\begin{bmatrix}1&2&1\\3&8&1\\0&4&1\end{bmatrix}=\begin{bmatrix}1&2&1\\0&2&-2\\0&4&1\end{bmatrix}$$（另外，如果三行都不变，消元矩阵就是单位矩阵$$I=\begin{bmatrix}1&0&0\\0&1&0\\0&0&1\end{bmatrix}$$，I之于矩阵运算相当于1之于四则运算。）这个消元矩阵我们记作$$E_{21}$$，即将第二行第一个元素变为零。

* 接下来就是求$$E_{32}$$消元矩阵了，即将第三行第二个元素变为零，则$$\begin{bmatrix}1&0&0\\0&1&0\\0&-2&1\end{bmatrix}\begin{bmatrix}1&2&1\\0&2&-2\\0&4&1\end{bmatrix}=\begin{bmatrix}1&2&1\\0&2&-2\\0&0&5\end{bmatrix}$$。这就是消元所用的两个初等矩阵（elementary matrix）。

* ***最后，我们将这两步综合起来，即$$E_{32}(E_{21}A)=U$$，***也就是说如果我们想从A矩阵直接得到U矩阵的话，只需要$$(E_{32}E_{21})A$$即可。注意，**矩阵乘法虽然不能随意变动相乘次序，但是可以变动括号位置，也就是满足结合律（associative law）**，而结合律在矩阵运算中非常重要，很多定理的证明都需要巧妙的使用结合律。

既然提到了消元用的初等矩阵，那我们再介绍一种用于置换两行的矩阵：置换矩阵(原理还是上述的行变换列变换等价于左乘右乘初等矩阵 )（permutation matrix）：例如$$\begin{bmatrix}0&1\\1&0\end{bmatrix}\begin{bmatrix}a&b\\c&d\end{bmatrix}=\begin{bmatrix}c&d\\a&b\end{bmatrix}$$，置换矩阵将原矩阵的两行做了互换。顺便提一下，如果我们希望交换两列，则有$$\begin{bmatrix}a&b\\c&d\end{bmatrix}\begin{bmatrix}0&1\\1&0\end{bmatrix}=\begin{bmatrix}b&a\\d&c\end{bmatrix}$$。

我们现在能够将A通过行变换写成U，那么如何从U再变回A，也就是求消元的逆运算。对某些“坏”矩阵，并没有逆，而本讲的例子都是“好”矩阵。

## 逆（inverse）

现在，我们以$$E_{21}$$为例，$$\Bigg[\quad ?\quad \Bigg]\begin{bmatrix}1&0&0\\-3&1&0\\0&0&1\end{bmatrix}=\begin{bmatrix}1&0&0\\0&1&0\\0&0&1\end{bmatrix}$$，什么矩阵可以取消这次行变换？这次变换是从第二行中减去三倍的第一行，那么其逆变换就是给第二行加上三倍的第一行，所以逆矩阵就是$$\begin{bmatrix}1&0&0\\3&1&0\\0&0&1\end{bmatrix}$$。

我们把矩阵E的逆记作$$E^{-1}$$，所以有$$E^{-1}E=I$$。

  
